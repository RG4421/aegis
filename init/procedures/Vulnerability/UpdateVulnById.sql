DROP PROCEDURE IF EXISTS `UpdateVulnByID`;

CREATE PROCEDURE `UpdateVulnByID`(_ID VARCHAR(36), _SourceVulnID NVARCHAR(255), _Title NVARCHAR(255), _SourceID VARCHAR(36), _CVSSScore FLOAT, _CVSS3Score FLOAT, _Description TEXT, _Threat TEXT,
                                                              _Solution MEDIUMTEXT, _Software TEXT, _Patchable VARCHAR(30),
                                                                  _DetectionInformation TEXT)
  #BEGIN#
  BEGIN
      UPDATE VulnerabilityInfo SET
      SourceVulnID = _SourceVulnID, Title = _Title, SourceID = _SourceID, CVSS = _CVSSScore, CVSS3 = NULLIF(_CVSS3Score, -1),
         Description = _Description, Threat = _Threat, Solution = _Solution, Software = _Software, DetectionInformation = _DetectionInformation, Patchable = NULLIF(_Patchable, ''),  Updated = NOW()
      WHERE ID = _ID LIMIT 1;
  END;