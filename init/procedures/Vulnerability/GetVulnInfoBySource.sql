/*
  RETURN VulnerabilityInfo
  ID                      VARCHAR(36)      NOT
  SourceVulnID            VARCHAR(255)     NOT
  Title                   VARCHAR(255)     NOT
  VulnerabilityID         VARCHAR(36)      NULL
  SourceID                VARCHAR(36)      NOT
  CVSSScore               FLOAT            NOT
  CVSS3Score              FLOAT            NULL
  Description             TEXT             NOT
  Threat                  TEXT             NULL
  Solution                TEXT             NOT
  DetectionInformation    TEXT             NULL
  Patchable               VARCHAR(30)      NULL
  Software                VARCHAR(300)     NULL
  Created                 DATETIME         NULL
  Updated                 DATETIME         NULL
*/

DROP PROCEDURE IF EXISTS `GetVulnInfoBySource`;

CREATE PROCEDURE `GetVulnInfoBySource` (_Source NVARCHAR(50))
  #BEGIN#
  SELECT
      VI.Id,
      VI.SourceVulnId,
      VI.Title,
      VI.VulnerabilityId,
      VI.SourceId,
      VI.CVSS,
      VI.CVSS3,
      VI.Description,
      VI.Threat,
      VI.Solution,
      VI.DetectionInformation,
      VI.Patchable,
      VI.Software,
      VI.Created,
      VI.Updated
  FROM VulnerabilityInfo VI
    JOIN Source S ON S.Id = VI.SourceId
  WHERE S.Source = _Source;